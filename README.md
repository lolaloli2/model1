Предоставленный код представляет собой систему рекомендаций фильмов, которая использует метод векторизации текста для создания рекомендаций. Сначала система загружает два кадра данных и из файлов CSV, содержащих информацию о фильмах и их титрах. Затем два кадра данных объединяются на основе столбца.moviescreditstitle
Объединенный фрейм данных предварительно обрабатывается для извлечения соответствующей информации, такой как жанры, ключевые слова, актерский состав и съемочная группа, а также для удаления любых отсутствующих или повторяющихся значений. Столбцы «Жанры», «Ключевые слова», «Актерский состав» и «Экипаж» затем преобразуются в список строк, а жанры, ключевые слова и актерский состав дополнительно обрабатываются для извлечения только соответствующей информации.
Предварительно обработанный фрейм данных затем используется для создания нового фрейма данных , который содержит только столбцы , и . Столбец создается путем объединения столбцов , , , и с последующим применением серии преобразований для удаления пробелов между словами и преобразования полученного текста в нижний регистр.new_dfmovie_idtitletagstagsoverviewgenreskeywordscastcrew
Затем кадр данных векторизуется с использованием функции из библиотеки. Векторизованные данные затем используются для расчета косинусного сходства между различными фильмами, что используется для выработки рекомендаций.new_dfCountVectorizersklearn
Функция рекомендаций принимает название фильма в качестве входных данных и возвращает список рекомендуемых фильмов на основе их косинусного сходства с входным фильмом. Функция сначала определяет индекс входного фильма в кадре данных, а затем вычисляет косинусные расстояния между входным фильмом и всеми остальными фильмами в кадре данных. Затем функция сортирует расстояния в порядке убывания и возвращает 5 лучших рекомендуемых фильмов.recommendnew_df
Затем модель экспортируется с использованием библиотеки, что позволяет использовать функцию рекомендаций в других приложениях путем загрузки сохраненного кадра данных и матрицы подобия.pickle
Таким образом, эта система рекомендаций использует подход векторизации текста для генерации рекомендаций, основанных на косинусном сходстве между различными фильмами. Система обучается на наборе данных фильмов и их титров, а полученную модель можно использовать для генерации рекомендаций для любого фильма в наборе данных.
